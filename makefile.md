# Λίγα λόγια για τα Makefile

Τα Makefile είναι αρχεία συνήθως φτιαγμένα να εκτελούς εντολές για C και Cpp αρχεία

# Βασικά πράγματα
Αρχικά μπορούμε να δημιουργήσουμε Comments με την δίεση (#)

```make
# Αυτό είναι ένα σχόλιο
CC=gcc # Αυτό δεν είναι σχόλιο
```
Στην πορεία θα μπούμε για τα πεδία μετά το make (arguments). Για παράδειγμα

```make
run: main.o other.o
    gcc -o main main.o other.o
```
Με τον από πάνω κώδικα, τρέχοντας την εντολή `make run` κάνεις compìle το πρόγραμμα με τα 2 object αρχεία. Τα αρχεία δεξιά από την : ελέγχονται και τρέχουν άλλες εντολές που θα αναφέρουμε παρακάτω

# Πεδία με αρχείο
Μπορείς να ορίσεις εντολές με βάση ένα όνομα αρχείου. με αυτόν τον τρόπο μπορείς να τρέχεις λιγότερες εντολές, καθώς μπορεί να τρέχεις μέρος των εντολών μόνο όσο χρειάζεται. Για παράδειγμα

```make
main.o: main.c
    gcc main.c -o main.o
other.o: other.c
    gcc other.c -o other.o
```
Ο παραπάνω κώδικας τρέχει όποτε δωθεί σαν όρισμα (dependency) το όνομα του αρχείου αριστερά της (:) 
# Wildcards

Φυσικά το να γράφεις ένα ένα τα ονόματα είναι ενοχλητικό. Οπότε μπορούμε να χρησιμοποιήσουμε ειδικούς χαρακτήρες για το make. Μερικά από αυτά είναι
    - $$(N) χρήση μεταβλητής του Makefile
    - $$@   για το όνομα του αρχείου αριστερά του (:)
    - %     χρησιμοποιείται όπως με το * με την διαφορά ότι δεν κρατάει την κατάληξη (πχ. main αντί για main.c)
    - $< Αρχεία που είναι με βάση το αριστερό τμήμα και δεξιά με βάση το αρχείο με το (%)

παράδειγμα με τους τελεστές

```make
# Εντολή compiler
CC=gcc
# σημαίες για αποσφαλμάτωση
CFLAGS=-c -Wall

Κατα την κλήση της make μπορείς να τα αλλάξεις και να τρέχεις το make με άλλα flags

```bash
make compile CC=clang
```

# Ονόματα από object αρχεία
```make
objects=main.o other.o
```

# Τρέχει και απλά με make η πρώτη
```make
compile: $(objects)
    $(CC) -o main

%.o: %.c
    # $< το όνομα του αρχείου %.o %.c 
    # για παράδειγμα main.o main.c 
    $(CC) $(CFLAGS) $< -o $@

cleanup:
    rm -rf *.o

```

# Χρήση εντολών υπό συνθήκη

```make
CC=gcc

compile:
ifeq(CC, gcc)
    gcc main.c -o main
else
    clang main.c -o main
endif

```

Εδώ βλέπουμε τον τρόπο που μπορεί να χρησιμοποιηθεί με βάση συνθήκη
η εντολή compile 

```make
compile:
ifdef STRING_TO_PRINT
    echo STRING_TO_PRINT
```

Μπορεί να χρησιμοποιηθεί και για αν υπάρχουν μεταβλητές
